<!DOCTYPE html>
<html lang="en">

<head>
    <title>Affirmation Classification with Multiple Evidence</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="https://s3.amazonaws.com/mturk-public/externalHIT_v1.js"></script>
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.0/css/all.css"
        integrity="sha384-lZN37f5QGtY3VHgisS14W3ExzMWZxybE1SJSEsQp9S+oqd12jhcu+A56Ebc1zFSJ" crossorigin="anonymous" />
    <style>
        input[type="range"].unmoved::-webkit-slider-thumb {
            border: 1px solid #dddddd;
            background: #dddddd;
        }

        input[type="range"].unmoved::-moz-range-thumb {
            border: 1px solid #dddddd;
            background-color: #dddddd;
        }

        .btn {border-radius: 0;}
    </style>
</head>

<body>
    <div class="container p-5">
        
        <!-- INSTRUCTION PANELS  -->
        <!-- ------------------------------------------------- -->
        <!-- THE TOGGLE BUTTON, THE NAVIGATION BUTTONS, THEN THE TEXT.-->
        <div id='instructions'>
            <div class="row justify-content-center">
                <button type="button" class="btn btn-primary col-sm-12 d-none" data-toggle="collapse"
                    data-target="#instructions-panel" id="instructions-toggle">
                    <span id="instructions-toggle-text">Show Instructions</span>
                </button>
            </div>
            <div id="instructions-btns" class="row">
                <button type="button" class="btn btn-primary mr-auto col-sm-2 mb-3 d-none" id="intro-previous">
                    Previous
                </button>
                <button type="button" class="btn btn-primary ml-auto col-sm-2 mb-3" id="intro-next">
                    Next
                </button>
                <button type="button" class="btn btn-success ml-auto col-sm-2 mb-3 d-none" id="ready-button">
                    Proceed
                </button+>
            </div>
            <div id="instructions-panel" class="row">
                <div class="col-sm-12 mx-auto border rounded shadow-sm text-center" style="background-color: #f5f5f5;">
                    <h4 class="text-left mt-3"><strong>Task instructions</strong></h4>
                    <div class="text-left">
                        <div id="instructions-0" class="instructions active">
                            <h5><b>Project</b></h5>
                            <div id="instructions-project-text">
                                <p>We are researchers at King's College London (KCL), United Kingdom, currently conducting research
                                to verify certain quality aspects of <a href='https://wikidata.org' target='_blank'>Wikidata</a>,
                                an open knowledge base that gathers claims and references to support these claims. This study is funded by
                                the European Union's Horizon 2020 research and innovation programme under grant agreement No 780247.
                                No personal information will be collected during this experiment and all data will be completely anonymous.
                                There are no foreseeable risks from participating, be they physical, psychological, legal, or any other type, and no way of identifying your personal details.</p>
                                <p>After you've submitted your responses, you can withdraw them by contacting the researchers (see next paragraph). The data collected in this
                                study will consist only of your inputs, the time you spent on the task and which buttons you clicked.
                                It will be stored in a password-protected computer and analysed for research purposes and its results published
                                in academic journals.</p>
                                <p>This experiment received ethical clearance on the 7th of April, 2022, by KCL, with
                                registration number MRA-21/22-29584. The data controller for this project will be KCL.
                                Research is a task that the University carries out in the public interest. Your data will be processed per the standards set by the General Data Protection Regulation 2016 (GDPR). If you have any questions or need further
                                assistance, please contact the researcher responsible for this study at
                                <a href='mailto:k2031554@kcl.ac.uk'>k2031554@kcl.ac.uk</a>.</p>
                                <p>By continuing with the task, you <b>agree</b> to take part in this research project and consent for
                                the data collected to be used for this study. Participation is voluntary and you may cancel
                                the task at any time for any reason before submitting it.</p>
                                <p><b>Please note</b> that to
                                proceed with the task you'll need a good comprehension of the English language! <b>This will be
                                measured by a very short and simple quiz</b>.</p>
                            </div>
                        </div>
                        <div id="instructions-1" class="instructions d-none">
                            <h5><b>Task Overview</b></h5>
                            <div id="instructions-intro-text">
                                <p>
                                    In this task, you must verift whether a collection of 5 passages, each containing some <u>highlighted text</u>, either support, refute or are inconclusive to an <b>affirmation</b>.
                                    You will be asked to do this 6 times during this task.
                                </p>
                                <p>
                                    Each time, you will receive an English <b>affirmation</b> (such as 'Obama was president of the US') and a set of 5 passages containing <u>highlighted text</u> extracted from a website (such as a BBC News article).
                                    Your goal is to tell us if, <i>when taken into consideration together</i> the <u>highlighted parts</u> of the passages support, refute, or are inconclusive to the <b>affirmation</b>.
                                </p>
                                <p>
                                    You will have the following four answer options: <b>Support</b>, <b>Refute</b>, <b>Neither</b> (they are inconclusive), and <b>Not Sure</b>.
                                    In case you select <b>Not Sure</b> we will ask you to select a reason from a predefined list.
                                </p>
                                <p>
                                    <b>Please note: </b>
                                    <ul>
                                        <li>
                                            We are not asking if the affirmation is true. Even if the affirmation is potentially or provably false, or goes against some common sense, please judge only if the highlighted text in the passage supports it, refutes it, or neither.
                                        </li>
                                        <li>
                                            The passages are automatically extracted from a website, so they might have strange formatting, such as a lack of punctuation and incomplete phrases.
                                            Please <b>do not let this lack of structure impact</b> your judgement much.  You can click on the website's URL to read the passages with their original format.
                                        </li>
                                        <li>
                                            Please only judge the <u>highlighted texts</u>. For example, if another portion of the passage that is <i>not</i> highlighted supports the affirmation, <i>but the highlighted text does not support it</i>, do not take its support into consideration.
                                        </li>
                                        <li>
                                            You can and should use the rest of the passage and the web page for clarifications and reference. For example, to clarify what pronouns (it/she/he/they) refer to.
                                        </li>
                                        <li>
                                            Consider the texts <i>taken together</i>, like pieces of evidence. For example, if one or more highlighted texts support and the rest is unrelated, then taken together they support.
                                        </li>
                                        <li>
                                            We will provide examples on the next page.
                                        </li>
                                    </ul>
                                </p>
                            </div>
                        </div>
                        <div id="instructions-2" class="instructions d-none">
                            <h5><b>Examples</b></h5>
                            <br>
                            <h6><b>Example #1</b></h6>
                            <p>
                                Affirmation: <b>Vidyasagar is a performer of Ponniyin Selvan.</b>  
                                <br> 
                                Link: <a href='https://en.wikipedia.org/w/index.php?title=Ponniyin_Selvan_(2005_film)&oldid=982538956' target='_blank'>https://en.wikipedia.org/w/index.php?title=Ponniyin_Selvan_(2005_film)&oldid=982538956</a>
                                <br>
                                <ul>
                                    <li>
                                        Passage 1:
                                        <br>
                                        &emsp; "Country India Language Tamil Budget ₹ 10 crore.
                                        <u>
                                            Ponniyin Selvan (English: The son of Ponni) is a 2005 Indian Tamil drama film written and directed by Radha Mohan.
                                            Produced by A. M. Ratnam, it stars his son Ravi Krishna, along with Gopika and Revathi in the lead roles, while Vidyasagar had composed the music for the film.
                                        </u>
                                        The film is unrelated to the same-titled novel by Kalki Krishnamurthy."
                                        <br>
                                    </li>
                                    <li>
                                        Passage 2:
                                        <br>
                                        &emsp; "Ponniyin Selvan (English: The son of Ponni) is a 2005 Indian Tamil drama film written and directed by Radha Mohan.
                                        <u>
                                            Produced by A. M. Ratnam, it stars his son Ravi Krishna, along with Gopika and Revathi in the lead roles, while Vidyasagar had composed the music for the film.
                                            The film is unrelated to the same-titled novel by Kalki Krishnamurthy.
                                        </u>
                                        It was released in Telugu as Muddhula Koduku and additionally featured Uttej and Venu Madhav as part of a separate comedy track shot."
                                        <br>
                                    </li>
                                    <li>
                                        Passage 3:
                                        <br>
                                        &emsp; "Ponniyin Selvan Soundtrack album by Vidyasagar Released 2005 Genre Soundtrack Label Five Star Audio Producer Vidyasagar Vidyasagar chronology.
                                        <u>
                                            Chandrolsavam (2005) Ponniyin Selvan (2005) London (2005)
                                        </u>
                                        "
                                        <br>
                                    </li>
                                    <li>
                                        Passage 4:
                                        <br>
                                        &emsp; "
                                        <u>
                                            Categories: 2005 films Tamil-language films Indian films 2000s Tamil-language films Tamil films scored by Vidyasagar Indian drama films 2005 drama films Films directed by Radha Mohan 2000s
                                        </u>
                                        Tamil-language film stubs Hidden categories: Articles with short description"
                                        <br>
                                    </li>
                                    <li>
                                        Passage 5:
                                        <br>
                                        &emsp; "Disclaimers. Contact Wikipedia.
                                        <u>
                                            Mobile view.
                                        </u>
                                        Developers. Statistics."
                                        <br>
                                    </li>
                                </ul>
                                The affirmation states that an entity named Vidyasagar is a performer of something called Ponniyin Selvan.
                                From the link/passages, we can see Vidyasagar is a musician and Ponniyin Selvan is a movie.
                                The first highlighted text directly supports that Vidyasagar composed the movie's music. The other highlighted texts all are either somewhat supportive or unrelated (like the 5th).
                                <i>Taken together</i>, these highlighted texts seem to <b>Support</b> the affirmation.
                            </p>
                            <h6><b>Example #2</b></h6>
                            <p>
                                Affirmation: <b>95 Bon-Accord Street, Aberdeen is located in Aberdeen.</b>  
                                <br> 
                                Link: <a href='http://portal.historicenvironment.scot/designation/LB20142' target='_blank'>http://portal.historicenvironment.scot/designation/LB20142</a>
                                <br>
                                <ul>
                                    <li>
                                        Passage 1:
                                        <br>
                                        &emsp; "Historic Environment Scotland head offices:
                                        <u>
                                            Longmore House Salisbury Place Edinburgh EH9 1SH. John Sinclair House 16 Bernard Terrace Edinburgh EH8 9NX.
                                        </u>
                                        Facebook. Twitter."
                                        <br>
                                    </li>
                                    <li>
                                        Passage 2:
                                        <br>
                                        &emsp; "Local Authority Aberdeen. Planning Authority Aberdeen. Burgh Aberdeen. NGR NJ 93751 5730.
                                        <u>
                                            Coordinates 393751, 805730.
                                        </u>
                                        Description. 1822 onwards."
                                        <br>
                                    </li>
                                    <li>
                                        Passage 3:
                                        <br>
                                        &emsp; "Planning Authority Aberdeen. Burgh Aberdeen. NGR NJ 93751 5730. Coordinates 393751, 805730. Description.
                                        <u>
                                            1822 onwards. 2-storey basement and attic, plain ashlar, 25-window, stepped in fall of ground.
                                        </u>
                                        References. Bibliography."
                                        <br>
                                    </li>
                                    <li>
                                        Passage 4:
                                        <br>
                                        &emsp; "Local Authority Aberdeen.
                                        <u>
                                            Planning Authority Aberdeen.
                                        </u>
                                        Burgh Aberdeen. NGR NJ 93751 5730."
                                        <br>
                                    </li>
                                    <li>
                                        Passage 5:
                                        <br>
                                        &emsp; "Facebook. Twitter. Linkedin.
                                        <u>
                                            Visitor App. Our app is your one-stop shop for information on Scotland's iconic historic attractions.
                                        </u>
                                        "
                                        <br>
                                    </li>
                                </ul>
                                The affirmation states that a specific address (95 Bon-Accord Street, Aberdeen) is in Aberdeen.
                                Although the affirmation might be self-confirming, <i>please only evaluate the highlighted texts</i>.
                                Highlighted texts 1 and 5 seem to be unrelated.
                                Highlighted text 3 just provides physical descriptions.
                                Highlighted text 2 describes coordinates (not clear what of, and not easy to check).
                                Highlighted text 4 describes a planning authority as Aberdeen, but does not say planning of what.
                                None of these specify the address 95 Bon-Accord Street is in Aberdeen.
                                So we can select <b>Neither</b>.
                            </p>
                            <h6><b>Example #3</b></h6>
                            <p>
                                Affirmation: <b>Julius is 53.1 centimetres tall.</b>  
                                <br> 
                                Link: <a href='https://www.rct.uk/collection/402419/julius' target='_blank'>https://www.rct.uk/collection/402419/julius</a>
                                <br>
                                <ul>
                                    <li>
                                        Passage 1:
                                        <br>
                                        &emsp; "1 of 253523 objects.
                                        <u>
                                            Richard Barrett Davis (1782-1854) "Julius" Signed and dated 1846. Oil on canvas | 53.1 x 65.4 x 1.5 cm (support, canvas/panel/str external) | RCIN 402419.
                                        </u>
                                        Your share link is... Close."
                                        <br>
                                    </li>
                                    <li>
                                        Passage 2:
                                        <br>
                                        &emsp; "Explore the Collection. /
                                        <u>
                                            Julius
                                        </u>
                                        / Search the collection."
                                        <br>
                                    </li>
                                    <li>
                                        Passage 3:
                                        <br>
                                        &emsp; "Davis belonged to a family of distinguished Royal huntsman; he was encouraged to paint animals by George III.
                                        <u>
                                            After training with Sir Francis Bourgeois and at the RA schools he became Animal Painter to George IV, William IV and Queen Victoria.
                                        </u>
                                        Nothing is known of the horse beyond his name, 'Julius'"
                                        <br>
                                    </li>
                                    <li>
                                        Passage 4:
                                        <br>
                                        &emsp; "Medium and techniques. Oil on canvas. oil paint, lined canvas.
                                        <u>
                                            Measurements. 53.1 x 65.4 x 1.5 cm (support, canvas/panel/str external) 69.8 x 85.1 x 5.8 cm (frame, external) Groupings.
                                        </u>
                                        Category. Paintings."
                                        <br>
                                    </li>
                                    <li>
                                        Passage 5:
                                        <br>
                                        &emsp; " Donate.
                                        <u>
                                            Contribute.
                                        </u>
                                        Help.
                                        <br>
                                    </li>
                                </ul>
                                The affirmation states Julius is 53.1 cm tall.
                                Reading the passages indicates "Julius" is a painting.
                                The first highlighted text directly states the dimensions of the painting, including 53.1 cm.
                                Checking the URL helps us conclude that 53.1 cm indeed refers to the height of the painting. 
                                Passages 2, 3, and 5 have no relevant highlighted text. The highlighted text of passage 4 also lists the measurements of the painting.
                                <i>Taken together</i>, since two support and three are unrelated, the highlighted texts <b>Support</b> the affirmation.
                                On some such cases, where a deduction is needed (the first dimension probably refers to height), we also accept <b>Neither</b> and <b>Not Sure</b>.
                            </p>
                            <br>
                            <h6><b>Neither</b></h6>
                            <p>
                                In cases where all five highlighted texts are unrelated to the affirmation, are not very informative, or contradict each other, you can select <b>Neither</b>.
                            </p>
                            <h6><b>Not Sure</b></h6>
                            <p>
                                Sometimes, affirmations might not be very clear or have words and terms that are too specific to one knowledge domain (like biology or chemistry).
                                For any case where you can not arrive at a conclusion, you can mark <b>Not Sure</b>.
                            </p>
                        </div>
                        <div id="instructions-3" class="instructions d-none">
                            <h5><b>Task rules</b></h5>
                            <p id="instructions-rules-text">
                                <ul>
                                    <li>
                                        You can navigate freely through the affirmation-passages sets using the buttons at the bottom of the page.
                                    </li>
                                    <li>
                                        You must fill in all the information requested.
                                    </li>
                                    <li>
                                        At the end of the task, we check some indicators of the quality of your work, to make sure you are not a spammer. If you don't pass the test, you can try two more times, for a total of three trials. If you fail three times, the task ends and the work is not accepted.
                                    </li>
                                    <li>
                                        This task will need you to have a good comprehension of English. Please answer the following short English language test and click on the green button to proceed. You can try the language test three times.
                                    </li>
                                    <li>
                                        You can open these instructions again anytime you wish.
                                    </li>
                                    <li>
                                        Make sure you are using either Chrome, Firefox, or Edge. <b>Do not use Internet Explorer.</b>
                                    </li>
                                    <li>
                                        If you suspect there is an error in the task, or think we are being unfair, contact us politely and we will do our best to resolve the issue.
                                    </li>
                                </ul>
                            </p>
                        </div>
                        <div id="instructions-4" class="instructions d-none">
                            <div id="attention_test" class="text-left">
                                <p><b>Attention Test:</b> Short English Quiz</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <br />

        <!-- TASK PANELS  -->
        <!-- ------------------------------------------------- -->
        <!-- THE TASK ITSELF. FILL AS NEEDED PER THE TASK.-->
        <div id="task-panel" class="row d-none">
            <div class="col-sm-12 mx-auto border rounded shadow-sm" style="background-color: #f5f5f5;">
                <h4 class="text-left mt-3">
                    Affirmation <strong><span id="current-page"></span></strong> of
                    <strong><span id="n-pages"></span></strong>:
                </h4>
                <br/>   
                <!---->
                <div class="row d-flex justify-content-center">
                    <div class="col-sm-11 pr-0 pl-0">
                        <h5>Read the following <b>affirmation</b>:</h5>
                    </div>
                </div>
                <div class="row d-flex justify-content-center">
                    <div class="col-sm-11 bg-light border rounded p-2" style="width: 100%;">
                        <p style="margin-top: 8px;margin-bottom: 8px;"><b><span id="affirmation"></b></span></p>
                    </div>
                </div>
                <br/>
                <!---->
                <div class="row d-flex justify-content-center">
                    <div class="col-sm-11 pr-0 pl-0">
                        <h5>
                            The following passages were extracted from this link: <a id="reference_url" href=""></a>
                            <br>
                            If you want, you can click on the link to see the passages with their original form and with more context.
                        </h5>
                    </div>
                </div>
                <br />
                <!---->
                <div class="row d-flex justify-content-center">
                    <div class="col-sm-11 pr-0 pl-0">
                        <h5>Now, read the following passages, paying particular attention to their <u>highlighted texts</u>:</h5>
                    </div>
                </div>
                <div class="row d-flex justify-content-center">
                    <div class="col-sm-11 bg-light border rounded p-2">
                        <p style="margin-top: 8px;margin-bottom: 8px;"><span id="passage_0"></span></p>
                    </div>
                </div>
                <br />
                <div class="row d-flex justify-content-center">
                    <div class="col-sm-11 bg-light border rounded p-2">
                        <p style="margin-top: 8px;margin-bottom: 8px;"><span id="passage_1"></span></p>
                    </div>
                </div>
                <br />
                <div class="row d-flex justify-content-center">
                    <div class="col-sm-11 bg-light border rounded p-2">
                        <p style="margin-top: 8px;margin-bottom: 8px;"><span id="passage_2"></span></p>
                    </div>
                </div>
                <br />
                <div class="row d-flex justify-content-center">
                    <div class="col-sm-11 bg-light border rounded p-2">
                        <p style="margin-top: 8px;margin-bottom: 8px;"><span id="passage_3"></span></p>
                    </div>
                </div>
                <br />
                <div class="row d-flex justify-content-center">
                    <div class="col-sm-11 bg-light border rounded p-2">
                        <p style="margin-top: 8px;margin-bottom: 8px;"><span id="passage_4"></span></p>
                    </div>
                </div>
                <br />
                <!---->
                <div class="row d-flex justify-content-center">
                    <div class="col-sm-11 pr-0 pl-0">
                        <h5>In your opinion, when taken into consideration <i>together</i>, how does the <u>highlighted texts</u> relate to the <b>affirmation</b>?</h5>
                    </div>
                </div>
                <div class="row d-flex justify-content-center">
                    <div class="col-sm-11 pr-0 pl-0">
                        <div id="relation_buttons" class="btn-group btn-group-vertical" data-toggle="buttons" style="width: 100%;">
                            <label id="relation_0" class="btn btn-primary text-left relation_button">
                                <input type="radio" autocomplete="off" value='unavailable' name='relation_buttons'> Taken together, the highlighted texts <b>SUPPORT</b> the affirmation
                            </label>
                            <label id="relation_1" class="btn btn-primary text-left relation_button">
                                <input type="radio" autocomplete="off" value='unavailable' name='relation_buttons'> Taken together, the highlighted texts <b>REFUTE</b> the affirmation
                            </label>
                            <label id="relation_2" class="btn btn-primary text-left relation_button">
                                <input type="radio" autocomplete="off" value='unavailable' name='relation_buttons'> Taken together, the highlighted texts <b>NEITHER</b> support nor refute the affirmation
                            </label>
                            <label id="relation_3" class="btn btn-primary text-left relation_button">
                                <input type="radio" autocomplete="off" value='unavailable' name='relation_buttons'> Not Sure
                            </label>
                        </div>
                    </div>
                </div>
                <br />
                
                <!---->
                <div id="reasons-not-sure-panel" class=''>
                    <div class="row d-flex justify-content-center">
                        <div class="col-sm-11 pr-0 pl-0">
                            <h5>If you marked <b>Not Sure</b>, please select one of the reasons why:</h5>
                        </div>
                    </div>
                    <div class="row d-flex justify-content-center">
                        <div class="col-sm-11 pr-0 pl-0">
                            <div id="reason_not_sure_buttons"  class="btn-group btn-group-vertical" data-toggle="buttons" style="width: 100%;">
                                <label id="reason_not_sure_0" class="btn btn-primary text-left reason_not_sure_button">
                                    <input type="radio" autocomplete="off" value='unavailable' name='reason_not_sure_radios'> I did not understand the meaning of the affirmation
                                </label>
                                <label id="reason_not_sure_1" class="btn btn-primary text-left reason_not_sure_button">
                                    <input type="radio" autocomplete="off" value='unavailable' name='reason_not_sure_radios'> I did not understand the meaning of the passage
                                </label>
                                <label id="reason_not_sure_2" class="btn btn-primary text-left reason_not_sure_button">
                                    <input type="radio" autocomplete="off" value='unavailable' name='reason_not_sure_radios'> I needed but could not access the link to get the passage's context 
                                </label>                                
                                <div class='container pl-0 pr-0 text-left' style="margin-left: -1px;margin-right: 0px;border-left-style: solid;border-left-width: 0px;">
                                    <label id="reason_not_sure_3" class="btn btn-primary text-left reason_not_sure_button col-sm-2">
                                        <input type="radio" autocomplete="off" value='unavailable' name='reason_not_sure_radios'> Other reason
                                    </label>
                                    <input id="reason_not_sure_other" type="text" autocomplete="off" placeholder='Please write it in this text box' class='h-75 w-75'>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!---->
                <div class="row p-3">
                    <button type="button" class="btn btn-primary col-sm-2 mr-auto" id="previous-page">
                        Previous
                    </button>
                    <button type="button" class="btn btn-success col-sm-2 ml-auto" id="presubmit" data-toggle="modal"
                        data-target="#submitModal">
                        Submit
                    </button>
                    <button type="button" class="btn btn-primary col-sm-2 ml-auto" id="next-page">
                        Next
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- MODALS -->
    <!-- ------------------------------------------------- -->
    <!-- SUBMIT MODAL-->
    <div class="modal" id="submitModal">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <!-- Modal Header -->
                <div class="modal-header">
                    <h4 class="modal-title mx-auto">Submit your work?</h4>
                </div>
                <!-- Modal body -->
                <div class="modal-body">
                    Please make sure every question has been properly answered before
                    submitting your work. Incomplete work will not be rewarded!
                </div>
                <!-- Modal footer -->
                <div class="modal-footer">
                    <input type="button" class="btn btn-danger ml-auto" data-dismiss="modal" value="Cancel" />
                    <input type="button" class="btn btn-success mr-auto" data-dismiss="modal" value="Submit"
                        id="submit" />
                </div>
            </div>
        </div>
    </div>
    <!-- ATTENTION TASK FAILURE MODAL -->
    <div class="modal" id="attErrorModal">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <!-- Modal Header -->
                <div class="modal-header">
                    <h4 class="modal-title mx-auto">Warning</h4>
                </div>
                <!-- Modal body -->
                <div class="modal-body">
                    <span id="att_warning_text">You didn't pass the attention test. Please review your
                        answers and try again!</span>
                </div>
                <!-- Modal footer -->
                <div class="modal-footer">
                    <input type="button" class="btn btn-warning mx-auto" data-dismiss="modal" value="OK"
                        id="att_close_error" />
                </div>
            </div>
        </div>
    </div>
    <!-- QUALITY CHECK FAILURE MODAL -->
    <div class="modal" id="errorModal">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <!-- Modal Header -->
                <div class="modal-header">
                    <h4 class="modal-title mx-auto">Warning</h4>
                </div>
                <!-- Modal body -->
                <div class="modal-body">
                    <span id="warning-text">Your answer didn't pass our quality check. Please review your
                        answers and try again!</span>
                    <span id="warning-hints"></span>
                </div>
                <!-- Modal footer -->
                <div class="modal-footer">
                    <input type="button" class="btn btn-warning mx-auto" data-dismiss="modal" value="OK"
                        id="close_error" />
                </div>
            </div>
        </div>
    </div>
    <!-- SUCCESS MODAL -->
    <div class="modal" id="successModal">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <!-- Modal Header -->
                <div class="modal-header">
                    <h4 class="modal-title mx-auto">Success!</h4>
                </div>
                <!-- Modal body -->
                <div class="modal-body">
                    <span id="success-text">Your answer passed our quality check! Press finish to submit
                        them. We appreciate any feedback you may have on the task.</span>
                </div>
                <textarea class="form-control" rows="5" id="feedback_text"
                    placeholder="Type your feeback here ..."></textarea>
                <!-- Modal footer -->
                <div class="modal-footer">
                    <input type="button" class="btn btn-success mx-auto" data-dismiss="modal" value="Finish"
                        id="close_success" />
                </div>
            </div>
        </div>
    </div>
    <!-- RETURNED VARIABLES AND SUBMIT BUTTON.-->
    <form name="mturk_form" method="post" id="mturk_form" action="https://www.mturk.com/mturk/externalSubmit">
        <input type="hidden" name="assignmentId"    value="" id="assignmentId" />
        <input type="hidden" name="outputs"         value="" id="outputs" />
        <input type="hidden" name="times"           value="" id="times" />
        <input type="hidden" name="events"          value="" id="events" />
        <input type="hidden" name="feedback"        value="" id="feedback" />

        <input type="submit" id="submitButton" style="visibility: hidden;" />
    </form>

    <!-- TASK LOGIC -->
    <script language="Javascript">
        // INITIALIZATION LOGIC
        // ---------------------------------------------------------------- //
        let affirmation_evidence_pairs = [
            {
                "identifiers":"0",
                "affirmation":"G V Raja died in Kullu Valley.0",
                "evidence_list": [
                    {
                        "pre_evidence":"0",
                        "evidence":"He died in an air crash near Kullu (Kulu) Valley on April 30, 1971. Sports journalists, historians, experts and sportsmen consider him as the Father of Sports and Tourism in Kerala.",
                        "post_evidence": "G. V. Raja's birth anniversary, 13 October, is observed as \"Kerala Sports Day\".",
                    },
                    {
                        "pre_evidence":"G. V. Raja was also the President of Tourism Promotion Council of Kerala.",
                        "evidence":"He was the main architect in developing Kovalam as an international tourist spot. He died in an air crash near Kullu (Kulu) Valley on April 30, 1971.",
                        "post_evidence": "",
                    },
                    {
                        "pre_evidence":"",
                        "evidence":"He died in an air crash near Kullu (Kulu) Valley on April 30, 1971.",
                        "post_evidence": "Sports journalists, historians, experts and sportsmen consider him as the Father of Sports and Tourism in Kerala.",
                    },
                    {
                        "pre_evidence":"",
                        "evidence":"P. R. Godavarma Raja Karthika Nal Godavarma Raja Born 13 October 1908 Poonjar Royal House, Kottayam Died 30 April 1971 Kullu Valley, Himachal Pradesh Cause of death Air Crash Spouse(s) Maharani Karthika Thirunal Lakshmi Bayi of Travancore (m. 1934)",
                        "post_evidence": "Children Crown Prince Rama Varma (died aged six)",
                    },
                    {
                        "pre_evidence":"He made an unscheduled trip to the Kulu Valley on 30 April 1971. ",
                        "evidence":"With two others, G V Raja flew in a three-seater aircraft which nose-dived and crashed, killing all its passengers.",
                        "post_evidence": "He was aged 62 at the time of his death.",
                    }
                ],                
                "reference_url":"https://www.google.com",
                "g_id": -1
            },
            {
                "identifiers":"1",
                "affirmation":"G V Raja died in Kullu Valley.1",
                "evidence_list": [
                    {
                        "pre_evidence":"1",
                        "evidence":"He died in an air crash near Kullu (Kulu) Valley on April 30, 1971. Sports journalists, historians, experts and sportsmen consider him as the Father of Sports and Tourism in Kerala.",
                        "post_evidence": "G. V. Raja's birth anniversary, 13 October, is observed as \"Kerala Sports Day\".",
                    },
                    {
                        "pre_evidence":"G. V. Raja was also the President of Tourism Promotion Council of Kerala.",
                        "evidence":"He was the main architect in developing Kovalam as an international tourist spot. He died in an air crash near Kullu (Kulu) Valley on April 30, 1971.",
                        "post_evidence": "",
                    },
                    {
                        "pre_evidence":"",
                        "evidence":"He died in an air crash near Kullu (Kulu) Valley on April 30, 1971.",
                        "post_evidence": "Sports journalists, historians, experts and sportsmen consider him as the Father of Sports and Tourism in Kerala.",
                    },
                    {
                        "pre_evidence":"",
                        "evidence":"P. R. Godavarma Raja Karthika Nal Godavarma Raja Born 13 October 1908 Poonjar Royal House, Kottayam Died 30 April 1971 Kullu Valley, Himachal Pradesh Cause of death Air Crash Spouse(s) Maharani Karthika Thirunal Lakshmi Bayi of Travancore (m. 1934)",
                        "post_evidence": "Children Crown Prince Rama Varma (died aged six)",
                    },
                    {
                        "pre_evidence":"He made an unscheduled trip to the Kulu Valley on 30 April 1971. ",
                        "evidence":"With two others, G V Raja flew in a three-seater aircraft which nose-dived and crashed, killing all its passengers.",
                        "post_evidence": "He was aged 62 at the time of his death.",
                    }
                ],
                "reference_url":"https://www.google.com",
                "g_id": -1
            },
            {
                "identifiers":"2",
                "affirmation":"G V Raja died in Kullu Valley.2",
                "evidence_list": [
                    {
                        "pre_evidence":"2",
                        "evidence":"He died in an air crash near Kullu (Kulu) Valley on April 30, 1971. Sports journalists, historians, experts and sportsmen consider him as the Father of Sports and Tourism in Kerala.",
                        "post_evidence": "G. V. Raja's birth anniversary, 13 October, is observed as \"Kerala Sports Day\".",
                    },
                    {
                        "pre_evidence":"G. V. Raja was also the President of Tourism Promotion Council of Kerala.",
                        "evidence":"He was the main architect in developing Kovalam as an international tourist spot. He died in an air crash near Kullu (Kulu) Valley on April 30, 1971.",
                        "post_evidence": "",
                    },
                    {
                        "pre_evidence":"",
                        "evidence":"He died in an air crash near Kullu (Kulu) Valley on April 30, 1971.",
                        "post_evidence": "Sports journalists, historians, experts and sportsmen consider him as the Father of Sports and Tourism in Kerala.",
                    },
                    {
                        "pre_evidence":"",
                        "evidence":"P. R. Godavarma Raja Karthika Nal Godavarma Raja Born 13 October 1908 Poonjar Royal House, Kottayam Died 30 April 1971 Kullu Valley, Himachal Pradesh Cause of death Air Crash Spouse(s) Maharani Karthika Thirunal Lakshmi Bayi of Travancore (m. 1934)",
                        "post_evidence": "Children Crown Prince Rama Varma (died aged six)",
                    },
                    {
                        "pre_evidence":"He made an unscheduled trip to the Kulu Valley on 30 April 1971. ",
                        "evidence":"With two others, G V Raja flew in a three-seater aircraft which nose-dived and crashed, killing all its passengers.",
                        "post_evidence": "He was aged 62 at the time of his death.",
                    }
                ],
                "reference_url":"https://www.google.com",
                "g_id": -1
            },
            {
                "identifiers":"3",
                "affirmation":"G V Raja died in Kullu Valley.3",
                "evidence_list": [
                    {
                        "pre_evidence":"3",
                        "evidence":"He died in an air crash near Kullu (Kulu) Valley on April 30, 1971. Sports journalists, historians, experts and sportsmen consider him as the Father of Sports and Tourism in Kerala.",
                        "post_evidence": "G. V. Raja's birth anniversary, 13 October, is observed as \"Kerala Sports Day\".",
                    },
                    {
                        "pre_evidence":"G. V. Raja was also the President of Tourism Promotion Council of Kerala.",
                        "evidence":"He was the main architect in developing Kovalam as an international tourist spot. He died in an air crash near Kullu (Kulu) Valley on April 30, 1971.",
                        "post_evidence": "",
                    },
                    {
                        "pre_evidence":"",
                        "evidence":"He died in an air crash near Kullu (Kulu) Valley on April 30, 1971.",
                        "post_evidence": "Sports journalists, historians, experts and sportsmen consider him as the Father of Sports and Tourism in Kerala.",
                    },
                    {
                        "pre_evidence":"",
                        "evidence":"P. R. Godavarma Raja Karthika Nal Godavarma Raja Born 13 October 1908 Poonjar Royal House, Kottayam Died 30 April 1971 Kullu Valley, Himachal Pradesh Cause of death Air Crash Spouse(s) Maharani Karthika Thirunal Lakshmi Bayi of Travancore (m. 1934)",
                        "post_evidence": "Children Crown Prince Rama Varma (died aged six)",
                    },
                    {
                        "pre_evidence":"He made an unscheduled trip to the Kulu Valley on 30 April 1971. ",
                        "evidence":"With two others, G V Raja flew in a three-seater aircraft which nose-dived and crashed, killing all its passengers.",
                        "post_evidence": "He was aged 62 at the time of his death.",
                    }
                ],
                "reference_url":"https://www.google.com",
                "g_id": -1
            },
            {
                "identifiers":"4",
                "affirmation":"G V Raja died in Kullu Valley.4",
                "evidence_list": [
                    {
                        "pre_evidence":"4",
                        "evidence":"He died in an air crash near Kullu (Kulu) Valley on April 30, 1971. Sports journalists, historians, experts and sportsmen consider him as the Father of Sports and Tourism in Kerala.",
                        "post_evidence": "G. V. Raja's birth anniversary, 13 October, is observed as \"Kerala Sports Day\".",
                    },
                    {
                        "pre_evidence":"G. V. Raja was also the President of Tourism Promotion Council of Kerala.",
                        "evidence":"He was the main architect in developing Kovalam as an international tourist spot. He died in an air crash near Kullu (Kulu) Valley on April 30, 1971.",
                        "post_evidence": "",
                    },
                    {
                        "pre_evidence":"",
                        "evidence":"He died in an air crash near Kullu (Kulu) Valley on April 30, 1971.",
                        "post_evidence": "Sports journalists, historians, experts and sportsmen consider him as the Father of Sports and Tourism in Kerala.",
                    },
                    {
                        "pre_evidence":"",
                        "evidence":"P. R. Godavarma Raja Karthika Nal Godavarma Raja Born 13 October 1908 Poonjar Royal House, Kottayam Died 30 April 1971 Kullu Valley, Himachal Pradesh Cause of death Air Crash Spouse(s) Maharani Karthika Thirunal Lakshmi Bayi of Travancore (m. 1934)",
                        "post_evidence": "Children Crown Prince Rama Varma (died aged six)",
                    },
                    {
                        "pre_evidence":"He made an unscheduled trip to the Kulu Valley on 30 April 1971. ",
                        "evidence":"With two others, G V Raja flew in a three-seater aircraft which nose-dived and crashed, killing all its passengers.",
                        "post_evidence": "He was aged 62 at the time of his death.",
                    }
                ],
                "reference_url":"https://www.google.com",
                "g_id": -1
            },
            {
                "identifiers":"5",
                "affirmation":"G V Raja died in Kullu Valley.5",
                "evidence_list": [
                    {
                        "pre_evidence":"5",
                        "evidence":"He died in an air crash near Kullu (Kulu) Valley on April 30, 1971. Sports journalists, historians, experts and sportsmen consider him as the Father of Sports and Tourism in Kerala.",
                        "post_evidence": "G. V. Raja's birth anniversary, 13 October, is observed as \"Kerala Sports Day\".",
                    },
                    {
                        "pre_evidence":"G. V. Raja was also the President of Tourism Promotion Council of Kerala.",
                        "evidence":"He was the main architect in developing Kovalam as an international tourist spot. He died in an air crash near Kullu (Kulu) Valley on April 30, 1971.",
                        "post_evidence": "",
                    },
                    {
                        "pre_evidence":"",
                        "evidence":"He died in an air crash near Kullu (Kulu) Valley on April 30, 1971.",
                        "post_evidence": "Sports journalists, historians, experts and sportsmen consider him as the Father of Sports and Tourism in Kerala.",
                    },
                    {
                        "pre_evidence":"",
                        "evidence":"P. R. Godavarma Raja Karthika Nal Godavarma Raja Born 13 October 1908 Poonjar Royal House, Kottayam Died 30 April 1971 Kullu Valley, Himachal Pradesh Cause of death Air Crash Spouse(s) Maharani Karthika Thirunal Lakshmi Bayi of Travancore (m. 1934)",
                        "post_evidence": "Children Crown Prince Rama Varma (died aged six)",
                    },
                    {
                        "pre_evidence":"He made an unscheduled trip to the Kulu Valley on 30 April 1971. ",
                        "evidence":"With two others, G V Raja flew in a three-seater aircraft which nose-dived and crashed, killing all its passengers.",
                        "post_evidence": "He was aged 62 at the time of his death.",
                    }
                ],
                "reference_url":"https://www.google.com",
                "g_id": -1
            },
        ]
        
        let attention_questions = [{"question": "He advised me ___ the doctor.", "options": ["that I see", "to see", "seeing", "see"], "answer": 1}, {"question": "Jane's ___ nice and polite.", "options": ["a", "from", "very", "at"], "answer": 2}, {"question": "You ___ to come if you don't want to.", "options": ["don't need", "needn't", "needn't have", "didn't need"], "answer": 0}, {"question": "By the time you arrive ___", "options": ["he'll leave", "he'll have left", "he leaves", "he left"], "answer": 1}]; 

        let total = affirmation_evidence_pairs.length;

        var outputs = [];
        // DEFAULT OUTPUTS IN JSON FORMAT, EX:  { similarity: -1, confidence: -1, reason: "" }
        // REPLACES THE GD FIELD WITH THE PROPER SET
        for (i = 0; i < total; i++) {
            outputs[i] = {relation: -1, reason_not_sure: -1, reason_not_sure_other: ""};
        }

        var events = [];

        function log_event(event_type, event_attr) {
            event_obj = {
                timestamp: new Date(),
                type: event_type
            };
            if (event_attr != null) {
                event_obj.attr = event_attr;
            }
            events.push(event_obj);
        }

        log_event("page_displayed", null);

        var times = Array(total).fill(0.0);
        var lastChange = null;

        taskFailCount = 0;
        attentionFailCount = 0;
   

        for (i = 0; i < attention_questions.length; i++) {
            $('#attention_test').append(`<p class="mb-0">${attention_questions[i]['question']}</p>`)
            $('#attention_test').append(`<div id="att_quest_${i}" class="btn-group btn-group-toggle mb-3" data-toggle="buttons">`)
            for (j = 0; j < attention_questions[i]['options'].length; j++)
                $(`#att_quest_${i}`).append(`<label class="btn btn-primary"><input type="radio" autocomplete="off" value=${j} name='att_quest_${i}'>${attention_questions[i]['options'][j]}<br/></label>`)
        }

        $("#n-pages").text(total);

        
        // FUNCTIONS
        // ---------------------------------------------------------------- //

        function showContent(currentPage) {
            if (lastChange) {
                times[parseInt($("#current-page").text()) - 1] +=
                    Date.now() - lastChange;
            }
            $("#current-page").text(currentPage);
            if (currentPage == 1) {
                $("#previous-page").hide();
                $("#next-page").show();
                $("#presubmit").hide();
            } else if (currentPage == total) {
                $("#previous-page").show();
                $("#next-page").hide();
                $("#presubmit").show();
            } else {
                $("#previous-page").show();
                $("#next-page").show();
                $("#presubmit").hide();
            }
            pageIndex = currentPage - 1;
            output = outputs[pageIndex];

            if (output["relation"] == -1) {
                $("#relation_0").removeClass('active');
                $("#relation_0").children('input').prop('checked',false)                
                $("#relation_1").removeClass('active');
                $("#relation_1").children('input').prop('checked',false)                  
                $("#relation_2").removeClass('active');
                $("#relation_2").children('input').prop('checked',false)             
                $("#relation_3").removeClass('active');                
                $("#relation_3").children('input').prop('checked',false) 
                $('#reasons-not-sure-panel').addClass('d-none');
            } else if (output["relation"] == 0) {
                $("#relation_0").addClass('active');
                $("#relation_0").children('input').prop('checked',true)                 
                $("#relation_1").removeClass('active');
                $("#relation_1").children('input').prop('checked',false)                 
                $("#relation_2").removeClass('active');
                $("#relation_2").children('input').prop('checked',false)              
                $("#relation_3").removeClass('active');
                $("#relation_3").children('input').prop('checked',false) 
                $('#reasons-not-sure-panel').addClass('d-none');
            } else if (output["relation"] == 1) {
                $("#relation_0").removeClass('active');
                $("#relation_0").children('input').prop('checked',false)                 
                $("#relation_1").addClass('active');
                $("#relation_1").children('input').prop('checked',true)                 
                $("#relation_2").removeClass('active');
                $("#relation_2").children('input').prop('checked',false)              
                $("#relation_3").removeClass('active');
                $("#relation_3").children('input').prop('checked',false) 
                $('#reasons-not-sure-panel').addClass('d-none');
            } else if (output["relation"] == 2) {
                $("#relation_0").removeClass('active');
                $("#relation_0").children('input').prop('checked',false)                 
                $("#relation_1").removeClass('active');
                $("#relation_1").children('input').prop('checked',false)                 
                $("#relation_2").addClass('active');
                $("#relation_2").children('input').prop('checked',true)              
                $("#relation_3").removeClass('active');
                $("#relation_3").children('input').prop('checked',false) 
                $('#reasons-not-sure-panel').addClass('d-none');
            } else if (output["relation"] == 3) {
                $("#relation_0").removeClass('active');
                $("#relation_0").children('input').prop('checked',false)                 
                $("#relation_1").removeClass('active');
                $("#relation_1").children('input').prop('checked',false)                 
                $("#relation_2").removeClass('active');
                $("#relation_2").children('input').prop('checked',false)              
                $("#relation_3").addClass('active');
                $("#relation_3").children('input').prop('checked',true) 
                $('#reasons-not-sure-panel').removeClass('d-none');
            }

            for (i = 0; i < $('#reason_not_sure_buttons').children().length; i++) {
                if (output['reason_not_sure'] == i){
                    $(`#reason_not_sure_${i}`).addClass("active");
                    $(`#reason_not_sure_${i}`).children('input').prop('checked',true)
                } else {
                    $(`#reason_not_sure_${i}`).removeClass("active");
                    $(`#reason_not_sure_${i}`).children('input').prop('checked',false)
                }
            }

            if (output["reason_not_sure_other"].replace(/\s+/g, "") != ""){
                $('#reason_not_sure_other').val(output["reason_not_sure_other"]);
            } else {
                $('#reason_not_sure_other').val("");
            }
            
            $("#affirmation").text(affirmation_evidence_pairs[pageIndex]["affirmation"]);

            for (i = 0; i < affirmation_evidence_pairs[pageIndex]['evidence_list'].length; i++) {
                $(`#passage_${i}`).empty()
                if (affirmation_evidence_pairs[pageIndex]["evidence_list"][i]["pre_evidence"] != ""){
                    $(`#passage_${i}`).append(
                        `${affirmation_evidence_pairs[pageIndex]["evidence_list"][i]["pre_evidence"]} `
                    );
                }
                $(`#passage_${i}`).append(
                    `<u>${affirmation_evidence_pairs[pageIndex]["evidence_list"][i]["evidence"]}</u>`
                );
                if (affirmation_evidence_pairs[pageIndex]["evidence_list"][i]["post_evidence"] != ""){
                    $(`#passage_${i}`).append(
                        ` ${affirmation_evidence_pairs[pageIndex]["evidence_list"][i]["post_evidence"]}`
                    );
                }
            }

            $("#reference_url").text(affirmation_evidence_pairs[pageIndex]["reference_url"]);
            $("#reference_url").attr("href", affirmation_evidence_pairs[pageIndex]["reference_url"]);
            

            lastChange = Date.now();
        }

        function validateRegex(str) {
            var reU = /^(null|(?!0*[.]0*$|[.]0*$|0*$)\d+[.]?\d{0,}$)/;
            return reU.test(str);
        }

        function verifyAttentionAnswers() {
            allOK = 4;
            for (i=0; i<attention_questions.length; i++){
                let chosen = parseInt($(`input[name="att_quest_${i}"]:checked`).val());
                if (chosen != attention_questions[i]['answer']){
                    allOK = allOK - 1
                }
            }
            return true//(allOK == 4) //CHANGE BACK FOR PRODUCTION
        }

        function verifyAnswers() {
            times[times.length - 1] += Date.now() - lastChange;
            lastChange = Date.now();

            var allControlsUsedCheck = true;
            const outputs_flat = [].concat(...outputs)
            for (s of outputs_flat) {
                if (
                    (s["relation"] == -1) ||
                    (s["relation"] == 3 && s["reason_not_sure"] == -1) ||
                    (s["reason_not_sure"] == 3 && s["reason_not_sure_other"].replace(/\s/g, "") == "")
                ) {
                    allControlsUsedCheck = false;
                }
            }
            if (!allControlsUsedCheck) {
                log_event("verification_check_failed", {
                    check_failed: "outputs_moved_check",
                    outputs: JSON.parse(JSON.stringify(outputs))
                });
            }

            var allTimesCheck = true;
            for (t of times) {
                if (t < 5000) {
                    allTimesCheck = false;
                }
            }
            if (!allTimesCheck) {
                log_event("verification_check_failed", {
                    check_failed: "minimum_time_check",
                    times: JSON.parse(JSON.stringify(times))
                });
            }

            var allGoldenCheck = true;
            for (i = 0; i < total; i++) {
                if (affirmation_evidence_pairs[i]['g_id'] != -1){
                    if (affirmation_evidence_pairs[i]['g_id'].indexOf(outputs[i]['relation']) == -1){
                        allGoldenCheck = false
                    }
                }
            }
                        
            if (!allGoldenCheck) {
                log_event("verification_check_failed", {
                    check_failed: "golden_standard_check",
                    outputs: JSON.parse(JSON.stringify(outputs))
                });
            }

            return {'controls':allControlsUsedCheck, 'times':allTimesCheck, 'golden':allGoldenCheck};
        }
        
        // DYNAMIC LOGIC
        // ---------------------------------------------------------------- //

        $(function () {
            $("#previous-page").click(function () {
                var page = parseInt($("#current-page").text());
                newPage = page - 1;
                showContent(newPage);
                log_event("moved_backward", {
                    new_page_index: newPage,
                    outputs: JSON.parse(JSON.stringify(outputs))
                });
            });
            $("#next-page").click(function () {
                var page = parseInt($("#current-page").text());
                newPage = page + 1;
                showContent(newPage);
                log_event("moved_forward", {
                    new_page_index: newPage,
                    outputs: JSON.parse(JSON.stringify(outputs))
                });
            });
            $("#ready-button").click(function () {
                if (verifyAttentionAnswers()){
                    $("#instructions-0").addClass("d-none");
                    $("#instructions-1").removeClass("d-none");
                    $("#instructions-2").removeClass("d-none");
                    $("#instructions-3").removeClass("d-none");
                    $("#instructions-4").addClass("d-none");
                    $("#instructions-btns").addClass("d-none");
                    $(this).addClass("d-none");
                    $("#instructions-toggle").removeClass("d-none");
                    $("#instructions-panel").addClass("collapse");
                    $("#task-panel").removeClass("d-none");
                    showContent(1);
                    log_event("task_started", null);
                } else {
                    attentionFailCount = attentionFailCount + 1;
                    if (attentionFailCount >= 3) {
                        $("#att_warning_text").html(
                            "You didn't pass the attention test.<br><br><strong>Unfortunately, you've reached the maximum amount of trials.<br><br>This window will be erased. Thank you very much for your work and please press return above so other worker may take this task.</strong>"
                        );
                        $("#attErrorModal").modal("toggle");
                        $("#attErrorModal").on("hidden.bs.modal", function () {
                            $("*").empty();
                        });
                    } else {
                        $("#attErrorModal").modal("toggle");
                    }
                }
            });
            $("#instructions-toggle").click(function () {
                is_shown = $("#instructions-panel").hasClass("show");
                if (is_shown) {
                    $("#instructions-toggle-text").text("Show Instructions");
                    log_event("closed_instructions", null);
                } else {
                    $("#instructions-toggle-text").text("Hide Instructions");
                    log_event("opened_instructions", null);
                }
            });
            $('.relation_button').click(function() {
                page = parseInt($("#current-page").text());
                pageIndex = page - 1;
                relation_idx = this.id.split('relation_')[1]
                if (relation_idx == '0'){
                    outputs[pageIndex]['relation'] = 0;
                    $('#reasons-no-panel').addClass('d-none')
                    $('#reasons-not-sure-panel').addClass('d-none')
                } else if (relation_idx == '1'){
                    outputs[pageIndex]['relation'] = 1;
                    $('#reasons-no-panel').removeClass('d-none')
                    $('#reasons-not-sure-panel').addClass('d-none')
                } else if (relation_idx == '2'){
                    outputs[pageIndex]['relation'] = 2;
                    $('#reasons-no-panel').removeClass('d-none')
                    $('#reasons-not-sure-panel').addClass('d-none')
                } else if (relation_idx == '3'){
                    outputs[pageIndex]['relation'] = 3;
                    $('#reasons-no-panel').addClass('d-none')
                    $('#reasons-not-sure-panel').removeClass('d-none')
                }
            });
            $('.reason_not_sure_button').click(function() {
                page = parseInt($("#current-page").text());
                pageIndex = page - 1;
                outputs[pageIndex]['reason_not_sure'] = parseInt(this.id.split('reason_not_sure_')[1]);
            });
            $('#reason_not_sure_other').change(function() {
                page = parseInt($("#current-page").text());
                pageIndex = page - 1;
                outputs[pageIndex]['reason_not_sure_other'] = $('#reason_not_sure_other').val();
            });
            $('#intro-next').click(function (){
                let current_instructions_active = $('div.instructions.active')[0];
                let current_instructions_id = parseInt(current_instructions_active.id.split('instructions-')[1]);
                $(`#instructions-${current_instructions_id}`).addClass('d-none').removeClass('active');
                $(`#instructions-${current_instructions_id+1}`).removeClass('d-none').addClass('active');
                if (current_instructions_id == 0){
                    $('#intro-previous').removeClass('d-none');
                } else if (current_instructions_id == 3){
                    $('#intro-next').addClass('d-none');
                    $('#ready-button').removeClass('d-none');
                }
            });
            $('#intro-previous').click(function (){
                let current_instructions_active = $('div.instructions.active')[0];
                let current_instructions_id = parseInt(current_instructions_active.id.split('instructions-')[1]);
                $(`#instructions-${current_instructions_id}`).addClass('d-none').removeClass('active');
                $(`#instructions-${current_instructions_id-1}`).removeClass('d-none').addClass('active');
                if (current_instructions_id == 4){
                    $('#ready-button').addClass('d-none');
                    $('#intro-next').removeClass('d-none');
                } else if (current_instructions_id == 1){
                    $('#intro-previous').addClass('d-none');
                }
            });
            $("#submit").click(function () {
                let verification = verifyAnswers();
                if (verification['controls'] && verification['times'] && verification['golden']){
                    $("#successModal").modal("toggle");
                    $("#successModal").on("hidden.bs.modal", function () {
                        log_event("task_finished", null);
                        $("#feedback").val($("#feedback_text").val());
                        $("#outputs").val(JSON.stringify(outputs));
                        $("#times").val(JSON.stringify(times));
                        $("#events").val(JSON.stringify(events));
                        $("#submitButton").trigger("click");
                    });
                } else {
                    taskFailCount = taskFailCount + 1;
                    $("#warning-hints").empty();
                    let warningString = "<ul>"
                    if (!verification['controls']){
                        warningString += "<li>You did not provide all required answers. Please provide answers to every question required. Maybe you skipped the last one. If you provided answers to a non-required question, that is ok. If you marked 'Other' as a reason, you need to specify what in the accompanying text box.</li>"
                    }
                    if (!verification['times']){
                        warningString += "<li>You seem to have filled some questions too quickly and we suspected bot activity. Spend a couple of seconds more in each item, maybe review your answers.</li>"
                    }
                    if (!verification['golden']){
                        warningString += "<li>We know the answers for a small number of control questions, and you seem to disagree with us. Please review your answers, but if you feel you are right even so, please contact the Requester.</li>"
                    }
                    warningString += "</ul>"
                    $("#warning-hints").html(warningString);
                    if (taskFailCount >= 3) {
                        $("#warning-text").html(
                            "Your answer didn't pass our quality check.<br><br><strong>Unfortunately, you've reached the maximum amount of trials.<br><br>This window will be erased. Thank you very much for your work and please press return above so other worker may take this task.</strong>"
                        );
                        $("#errorModal").modal("toggle");
                        $("#errorModal").on("hidden.bs.modal", function () {
                            $("*").empty();
                        });
                    } else {
                        $("#errorModal").modal("toggle");
                    }
                }
            });
        });

        // OBLIGATORY CALL TO SET TURK ASSIGNMENT
        turkSetAssignmentID();
    </script>
</body>

</html>